<div class="container">
  <div class="row" style="margin-top: 25px;">
    <div class="col-lg-12 col-md-12 hidden-xs" style="padding-left: 0px; padding-right: 0px;">
      <div class="col-lg-1 col-md-1 col-lg-offset-8 col-md-offset-8"
        style="text-align: right; padding-left: 0px; padding-right: 0px;">
        <button type="button" class="btn btn-danger btn-circle btn-lg" ui-sref="account.dashboard"><i
            class="glyphicon glyphicon-remove"></i></button>
      </div>
    </div>
    <div class="col-xs-12 hidden-lg hidden-md hidden-sm" style="padding-left: 0px; padding-right: 0px;">
      <button type="button" class="btn btn-danger xxxl" ui-sref="account.dashboard">
        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> {{'CANCEL'|translate}}
      </button>
    </div>
  </div>
  <div class="row" style="margin-top: 25px;">
    <div class="col-lg-12 col-md-12 col-sm 12 col-xs-12" style="padding-left: 0px; padding-right: 0px;">
      <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2 col-lg-offset-3 col-md-offset-3"
        style="padding-left: 0px; padding-right: 0px;">
        <button type="button" class="btn btn-default btn-circle btn-lg" ng-click="register.stepBack()"
          ng-disabled="register.stepIndex == 0;"><i class="glyphicon glyphicon-chevron-left"></i></button>
      </div>
      <div class="col-lg-4 col-md-4 col-sm-10 col-xs-8" style="text-align: center;">
        <h3 style="margin-top: 14px;">{{register.stepTitle}}</h3>
      </div>
      <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2"
        style="text-align: right; padding-left: 0px; padding-right: 0px;">
        <button type="button" class="btn btn-default btn-circle btn-lg" ng-click="register.stepForward()"
          ng-show="register.showNext" ng-disabled="register.stepIsValid === false"><i
            class="glyphicon glyphicon-chevron-right"></i></button>
        <button type="button" class="btn btn-default btn-circle btn-lg" ng-click="register.completeRegistration()"
          ng-hide="register.showNext" ng-disabled="register.completed"><i class="glyphicon glyphicon-ok"></i></button>
      </div>
    </div>
  </div>
  <div class="row" style="margin-bottom: 50px;">
    <div class="col-lg-6 col-md-6 col-lg-offset-3 col-md-offset-3" style="padding-left: 0px; padding-right: 0px;">
      <wizard class="registration-wizard" name="RegistrationWizard" hide-indicators="true">
        <wz-step wz-title="{{'STEP0' | translate}}" wz-data="{translation: 'STEP0'}">
          <hr>
          <div uib-alert class="alert-warning" ng-bind-html="'STEP0_DESCRIPTION'|translate"></div>
          <hr>
          <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 col-lg-offset-9 col-md-offset-9"
            style="padding-left: 0px; padding-right: 0px;">
            <div class="input-group">
              <span class="input-group-addon">
                <input type="checkbox" name="provacy" id="privacy" ng-model="register.stepIsValid" />
                <label for="privacy">{{'AGREE'|translate}}</label>
              </span>
              <span class="input-group-btn">
                <button class="btn btn-primary" type="submit" ng-click="register.setStepTitle()" wz-next
                  ng-disabled="register.stepIsValid === false">{{'NEXT'
                  | translate}}</button>
              </span>
            </div>
          </div>
        </wz-step>
        <wz-step wz-title="{{'STEP2' | translate}}" wz-data="{translation: 'STEP2'}">
          <input type="checkbox" ng-checked="register.stepIsValidChange(senseboxForm.$valid)" ng-hide="true">
          <hr>
          <form class="tab-pane" id="sensebox" name="senseboxForm" ng-keypress="register.enterEvent($event)" novalidate>
            <div id="general">
              <div class="text-center">
                <h1><small>{{ 'STEP2_SUB1' | translate }}</small></h1>
              </div>
              <div class="alert alert-info" role="alert">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                {{'STEP2_SUB1_DESCRIPTION' | translate}}
              </div>

              <!-- NAME -->
              <div class="form-group has-feedback"
                ng-class="{ 'has-error' : senseboxForm.name.$invalid, 'has-success' :  senseboxForm.name.$valid }">
                <label class="control-label">{{ 'NAME_YOUR_STATION' | translate}}*</label>
                <input type="text" name="name" class="form-control" ng-model="register.newSenseBox.name"
                  title="{{ 'PLEASE_SPECIFY_FIRSTNAME' | translate }}" required>
                <span ng-show="senseboxForm.name.$valid" class="glyphicon glyphicon-ok form-control-feedback"
                  aria-hidden="true"></span>
                <span ng-show="senseboxForm.name.$invalid" class="glyphicon glyphicon-remove form-control-feedback"
                  aria-hidden="true"></span>
              </div>

              <!-- Aufstellungsort -->
              <div class="form-group has-feedback"
                ng-class="{ 'has-error' : senseboxForm.exposure.$invalid, 'has-success' :  senseboxForm.exposure.$valid }">
                <label class="control-label">{{'STATION_PLACEMENT'|translate}}*</label>
                <div class="radio radio-success">
                  <input type="radio" name="exposure" id="indoor" value="indoor"
                    ng-model="register.newSenseBox.exposure" required>
                  <label for="indoor">
                    {{'STATION_PLACEMENT_INDOOR'|translate}}
                  </label>
                </div>
                <div class="radio radio-success">
                  <input type="radio" name="exposure" id="outdoor" value="outdoor"
                    ng-model="register.newSenseBox.exposure" required>
                  <label for="outdoor">
                    {{'STATION_PLACEMENT_OUTDOOR'|translate}}
                  </label>
                </div>
                <div class="radio radio-success">
                  <input type="radio" name="exposure" id="mobile" value="mobile"
                    ng-model="register.newSenseBox.exposure" required>
                  <label for="mobile">
                    {{'STATION_PLACEMENT_MOBILE'|translate}}
                  </label>
                </div>
                <span ng-show="senseboxForm.exposure.$valid" class="glyphicon glyphicon-ok form-control-feedback"
                  aria-hidden="true"></span>
                <span ng-show="senseboxForm.exposure.$invalid" class="glyphicon glyphicon-remove form-control-feedback"
                  aria-hidden="true"></span>
              </div>

              <!-- Gruppenkennzeichnung -->
              <div class="form-group">
                <label class="control-label">{{'GROUP_NAME'|translate}}</label>
                <input type="text" name="tag" class="form-control" ng-model="register.tag"
                  placeholder="{{'PLEASE_SPECIFY_GROUPID'|translate}}">
              </div>
            </div>
            <hr>
            <!-- Location -->
            <div id="location">
              <div class="text-center">
                <h1><small>{{ 'STEP2_SUB2' | translate }}</small></h1>
              </div>
              <div class="alert alert-info" role="alert">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                {{'STEP2_SUB2_DESCRIPTION' | translate}}
              </div>
              <div id="register-map" class="row" style="height: 400px;">
                <osem-map id="map_register" markers="register.markers" events="register.events"></osem-map>
              </div>
              <div id="boxPosition" class="row">
                <div class="col-md-4">
                  <div class="form-group has-feedback"
                    ng-class="{'has-error': senseboxForm.boxLat.$invalid, 'has-success' :  senseboxForm.boxLat.$valid && register.editMarkerInput.box!==undefined}">
                    <label for="boxLat">{{'BOX_LATITUDE'|translate}}</label>
                    <input name="boxLat" class="form-control" type="number" min="-85.06" max="85.06"
                      ng-model="register.editMarkerInput.box.lat" step="0.000001" required>
                    <span ng-show="senseboxForm.boxLat.$valid && register.editMarkerInput.box!==undefined"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="senseboxForm.boxLat.$invalid"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group has-feedback"
                    ng-class="{'has-error': senseboxForm.boxLng.$invalid, 'has-success' :  senseboxForm.boxLng.$valid && register.editMarkerInput.box!==undefined}">
                    <label for="boxLng">{{'BOX_LONGITUDE'|translate}}</label>
                    <input name="boxLng" class="form-control" type="number" min="-180" max="180"
                      ng-model="register.editMarkerInput.box.lng" step="0.000001" required>
                    <span ng-show="senseboxForm.boxLng.$valid && register.editMarkerInput.box!==undefined"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="senseboxForm.boxLng.$invalid"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group has-feedback"
                    ng-class="{'has-error': senseboxForm.boxHeight.$invalid, 'has-success' :  senseboxForm.boxHeight.$valid && register.editMarkerInput.box!==undefined}">
                    <label for="boxHeight">{{'BOX_HEIGHT'|translate}}</label>
                    <input name="boxHeight" class="form-control" type="number"
                      ng-model="register.editMarkerInput.box.height" step="0.5">
                    <span ng-show="senseboxForm.boxHeight.$valid && register.editMarkerInput.box!==undefined"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="senseboxForm.boxHeight.$invalid"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <!-- Hardware -->
            <div id="hardware">
              <div class="text-center">
                <h1><small>{{ 'STEP2_SUB3' | translate }}</small></h1>
              </div>
              <uib-accordion close-others="true">
                <div uib-accordion-group class="panel-default" is-open="register.open.edu">
                  <uib-accordion-heading>
                    senseBox:edu <i class="pull-right glyphicon"
                      ng-class="{'glyphicon-chevron-down': register.open.collapse7, 'glyphicon-chevron-right': !register.open.collapse7}"></i>
                  </uib-accordion-heading>
                  <div class="row" style="text-align: center;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img src="https://sensebox.kaufen/api//public/uploads/thumbs/thumb--1524084036833-hds%20top.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>HDC1080</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('HDC1080_TEMPERATURE')">{{'TEMPERATURE' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('HDC1080_HUMIDITY')">{{'HUMIDITY' | translate}}</button>
                          </p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img
                          src="https://sensebox.kaufen/api//public/uploads/thumbs/thumb--1524085326737-bmp%20v2%20top.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>BMP280</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BMP280_PRESSURE')">{{'AIRPRESSURE' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BMP280_TEMPERATURE')">{{'TEMPERATURE' | translate}}</button>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row" style="text-align: center;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img
                          src="https://sensebox.kaufen/api//public/uploads/thumbs/thumb--1525169435866-v+uv%20bottom.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>TSL45315 & VEML6070</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('TSL45315')">{{'ILLUMINATION' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('VEML6070')">{{'UV'|translate}}</button>
                          </p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img
                          src="https://sensebox.kaufen/api//public/uploads/thumbs/thumb--1525358769594-nova-fitness-sds011-laser-pm25-pm10-dust-feinstaub-sensor-modul-luft-qualitaet-detector-built-in-fan.jpg"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>SDS011</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('PM25')">PM2.5</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('PM10')">PM10</button>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row" style="text-align: center;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img
                          src="https://sensebox.kaufen/api//public/uploads/thumbs/thumb--1559804795021-bme_v2_top.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>BME680</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_TEMPERATURE')">{{'TEMPERATURE' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_HUMIDITY')">{{'HUMIDITY' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_PRESSURE')">{{'AIRPRESSURE' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_IAQ')">{{'IAQ' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_CALIBRATION')">{{'CALIBRATION' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_CO2')">{{'CO2' | translate}}</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('BME680_VOC')">{{'VOC' | translate}}</button>
                          </p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img src="https://sensebox.kaufen/api/public/uploads/1572259222502-SMT50_freigestellt_02.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>SMT50</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('smt50_soilmoisture')">Bodenfeuchte</button>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('smt50_soiltemperature')">Bodentemperatur</button>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row" style="text-align: center;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="thumbnail">
                        <img
                          src="https://sensebox.kaufen/api/public/uploads/1579187023927-176092104_illustrator_02_gimp%20overlay_cropped.png"
                          style="vertical-align: middle; height: 90px; width: 90px;" alt="">
                        <div class="caption">
                          <h4>Sound Level Meter</h4>
                          <p>
                            <button type="button" class="btn btn-success"
                              ng-click="register.addSensorTemplate('soundlevelmeter')">{{'SOUND_LEVEL'|translate}}</button>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <br>
                  <hr>
                  <table class="table table-striped table-bordered">
                    <thead>
                      <tr style="font-weight: bold">
                        <td style="width:15%">{{'CONFIG_ICON'|translate}}</td>
                        <td style="width:35%">{{'CONFIG_PHENOMENON'|translate}}</td>
                        <td style="width:20%">{{'CONFIG_UNIT'|translate}}</td>
                        <td style="width:20%">{{'CONFIG_TYPE'|translate}}</td>
                        <td style="width:25%">&nbsp;</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="sensor in register.sensors">
                        <td>
                          <input type="text" name="icon{{sensor.id}}" ng-hide="true" ng-model="sensor.icon" required>
                          <div class="form-group has-feedback"
                            ng-class="{ 'has-error' : senseboxForm.icon{{sensor.id}}.$invalid, 'has-success' : senseboxForm.icon{{sensor.id}}.$valid && sensor.icon!='' }">
                            <div class="btn-group xxxl" uib-dropdown
                              ng-show="register.editing[sensor.id] && !register.isCustom[sensor.id]">
                              <button id="btn-append-to-body" type="button" class="form-control btn btn-default xxxl"
                                uib-dropdown-toggle>
                                <span class="icon osem-icon" ng-class="sensor.icon"></span><span
                                  class="icon-caret caret"></span>
                              </button>
                              <ul class="dropdown-menu list-inline" uib-dropdown-menu role="menu"
                                aria-labelledby="btn-append-to-body">
                                <li ng-repeat="icon in register.icons" ng-click="register.setSensorIcon(sensor,icon)">
                                  <span class="osem-icon" ng-class="icon.name"></span>
                                </li>
                              </ul>
                            </div>
                            <span ng-show="senseboxForm.icon{{sensor.id}}.$valid && sensor.icon!=''"
                              class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                            <span ng-show="senseboxForm.icon{{sensor.id}}.$invalid"
                              class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                          </div>
                        </td>
                        <td>
                          <div class="form-group has-feedback"
                            ng-class="{ 'has-error' : senseboxForm.phenomenom{{sensor.id}}.$invalid, 'has-success' : senseboxForm.phenomenom{{sensor.id}}.$invalid && sensor.title!='' }">
                            <input name="phenomenom{{sensor.id}}" class="form-control" type="text"
                              ng-model="sensor.title" required>
                            <span ng-show="senseboxForm.phenomenom{{sensor.id}}.$valid && sensor.title!=''"
                              class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                            <span ng-show="senseboxForm.phenomenom{{sensor.id}}.$invalid"
                              class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                          </div>
                        </td>
                        <td>
                          <div class="form-group has-feedback"
                            ng-class="{'has-error': senseboxForm.unit{{sensor.id}}.$invalid, 'has-success' : senseboxForm.unit{{sensor.id}}.$valid && sensor.unit!==''}">
                            <input name="unit{{sensor.id}}" class="form-control" type="text" ng-model="sensor.unit"
                              required>
                            <span ng-show="senseboxForm.unit{{sensor.id}}.$valid && sensor.unit!==''"
                              class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                            <span ng-show="senseboxForm.unit{{sensor.id}}.$invalid"
                              class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                          </div>
                        </td>
                        <td>
                          <div class="form-group has-feedback"
                            ng-class="{'has-error': senseboxForm.sensorType{{sensor.id}}.$invalid, 'has-success' : senseboxForm.sensorType{{sensor.id}}.$valid && sensor.sensorType!==''}">
                            <input name="sensorType{{sensor.id}}" class="form-control" type="text"
                              ng-model="sensor.sensorType" required>
                            <span ng-show="senseboxForm.sensorType{{sensor.id}}.$valid && sensor.sensorType!==''"
                              class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                            <span ng-show="senseboxForm.sensorType{{sensor.id}}.$invalid"
                              class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                          </div>
                        </td>
                        <td style="white-space: nowrap">
                          <button type="button" class="btn btn-danger" ng-show="register.editing[sensor.id]"
                            ng-click="register.remove(sensor.id);">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <div uib-alert class="alert-danger" ng-show="register.sensorIncomplete">{{
                    'CUSTOMBOX_SENSORINCOMPLETE'|translate }}</div>
                  <div class="col-lg-12" ng-show="register.modelSelected.id == 'edu'">
                    <button type="button" ng-click="register.add();" class="btn btn-default"><i
                        class="fa fa-plus-circle"></i>
                      {{'ADD_SENSOR'|translate}}</button>
                    <hr>
                  </div>
                </div>
                <div uib-alert class="alert-danger" ng-show="register.invalidHardware">{{
                  'REG_HARDWAREINCOMPLETE'|translate }}</div>
              </uib-accordion>
            </div>
            <div id="advanced">
              <div class="text-center">
                <h1><small>{{ 'STEP2_SUB4' | translate }}</small></h1>
              </div>
              <uib-accordion close-others="true">
                <div uib-accordion-group class="panel-default" is-open="register.open.mqtt">
                  <div uib-alert class="alert-warning" ng-bind-html="'MQTT_DESCRIPTION'|translate"></div>
                  <uib-accordion-heading>
                    MQTT <i class="pull-right glyphicon"
                      ng-class="{'glyphicon-chevron-down': register.open.collapse4, 'glyphicon-chevron-right': !register.open.collapse4}"></i>
                  </uib-accordion-heading>
                  <div class="checkbox checkbox-success checkbox-inline">
                    <input type="checkbox" id="enableMQTT" ng-model="register.mqtt.enabled">
                    <label for="enableMQTT">{{ 'MQTT_ENABLE' | translate }}</label>
                  </div>

                  <!-- MQTT URL -->
                  <div class="form-group has-feedback"
                    ng-class="{ 'has-error' : register.mqtt.enabled && !register.validMQTTURL, 'has-success' : register.mqtt.enabled && register.validMQTTURL }">
                    <label class="control-label">{{ 'MQTT_URL' | translate}}*</label>
                    <input type="text" name="url" class="form-control" ng-model="register.mqtt.url"
                      ng-required="register.mqtt.enabled" ng-disabled="!register.mqtt.enabled">
                    <span ng-show="register.mqtt.enabled && register.validMQTTURL"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="register.mqtt.enabled && !register.validMQTTURL"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                  </div>
                  <!-- MQTT TOPIC -->
                  <div class="form-group has-feedback"
                    ng-class="{ 'has-error' : senseboxForm.topic.$invalid, 'has-success' : senseboxForm.topic.$valid && register.mqtt.topic!='' }">
                    <label class="control-label">{{ 'MQTT_TOPIC' | translate}}*</label>
                    <input type="text" name="topic" class="form-control" ng-model="register.mqtt.topic"
                      ng-required="register.mqtt.enabled" ng-disabled="!register.mqtt.enabled">
                    <span ng-show="senseboxForm.topic.$valid && register.mqtt.topic!=''"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="senseboxForm.topic.$invalid" class="glyphicon glyphicon-remove form-control-feedback"
                      aria-hidden="true"></span>
                  </div>
                  <!-- MQTT MessageFormat -->
                  <div class="form-group has-feedback"
                    ng-class="{ 'has-error' : senseboxForm.messageFormat.$invalid, 'has-success' :  senseboxForm.messageFormat.$valid && register.mqtt.messageFormat!='' }">
                    <label class="control-label">{{'MQTT_MESSAGEFORMAT'|translate}}*</label>
                    <div class="radio radio-success">
                      <input type="radio" name="messageFormat" id="mqtt-messageformat-json" value="json"
                        ng-model="register.mqtt.messageFormat" ng-required="register.mqtt.enabled"
                        ng-disabled="!register.mqtt.enabled">
                      <label for="mqtt-messageformat-json">
                        {{'MQTT_MESSAGEFORMAT_JSON'|translate}}
                      </label>
                    </div>
                    <div class="radio radio-success">
                      <input type="radio" name="messageFormat" id="mqtt-messageformat-csv" value="csv"
                        ng-model="register.mqtt.messageFormat" ng-required="register.mqtt.enabled"
                        ng-disabled="!register.mqtt.enabled">
                      <label for="mqtt-messageformat-csv">
                        {{'MQTT_MESSAGEFORMAT_CSV'|translate}}
                      </label>
                    </div>
                    <span ng-show="senseboxForm.messageFormat.$valid && register.mqtt.messageFormat!=''"
                      class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    <span ng-show="senseboxForm.messageFormat.$invalid"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                  </div>
                  <!-- MQTT DecodeOptions -->
                  <div class="form-group">
                    <label class="control-label">{{ 'MQTT_DECODEOPTIONS' | translate}}</label>
                    <input type="text" name="decodeOptions" class="form-control" ng-model="register.mqtt.decodeOptions"
                      ng-disabled="!register.mqtt.enabled">
                  </div>
                  <!-- MQTT ConnectionOptions -->
                  <div class="form-group">
                    <label class="control-label">{{ 'MQTT_CONNECTIONOPTIONS' | translate}}</label>
                    <input type="text" name="connectionOptions" class="form-control"
                      ng-model="register.mqtt.connectionOptions" ng-disabled="!register.mqtt.enabled">
                  </div>
                  <div ng-show="register.mqtt.enabled">
                    <div uib-alert class="alert-danger" ng-hide="register.validMQTTURL">{{ 'MQTT_INVALID_URL' |
                      translate }}</div>
                  </div>
                </div>
                <div uib-accordion-group class="panel-default" is-open="register.open.ttn">
                  <uib-accordion-heading>
                    TheThingsNetwork - TTN <i class="pull-right glyphicon"
                      ng-class="{'glyphicon-chevron-down': register.open.collapse5, 'glyphicon-chevron-right': !register.open.collapse5}"></i>
                  </uib-accordion-heading>
                  <div uib-alert class="alert-warning" ng-bind-html="'TTN_DESCRIPTION'|translate"></div>
                  <div class="checkbox checkbox-success checkbox-inline">
                    <input type="checkbox" id="enabledTTN" ng-model="register.ttnEnabled">
                    <label for="enabledTTN">{{ 'EDIT_TTN' | translate }}</label>
                  </div>
                  <!-- TTN profile  -->
                  <div class="form-group"
                    ng-class="{'has-error': senseboxForm.ttn_profile.$invalid, 'has-success': senseboxForm.ttn_profile.$valid }">
                    <label class="control-label">{{ 'TTN_PROFILE' | translate }}</label>
                    <select name="ttn_profile" class="form-control" ng-model="register.ttn.profile"
                      ng-required="register.ttnEnabled" ng-disabled="!register.ttnEnabled">
                      <option value="sensebox/home">senseBox:home</option>
                      <option value="lora-serialization">LoRa serialization</option>
                      <option value="json">JSON</option>
                    </select>
                  </div>
                  <!-- TTN app_id -->
                  <div class="form-group"
                    ng-class="{'has-error': senseboxForm.ttn_app_id.$invalid, 'has-success': senseboxForm.ttn_app_id.$valid }">
                    <label class="control-label">{{ 'TTN_APPID' | translate }}</label>
                    <input type="text" name="ttn_app_id" class="form-control" ng-model="register.ttn.app_id"
                      ng-required="register.ttnEnabled" ng-disabled="!register.ttnEnabled">
                  </div>
                  <!-- TTN dev_id -->
                  <div class="form-group"
                    ng-class="{'has-error': senseboxForm.ttn_dev_id.$invalid, 'has-success': senseboxForm.ttn_dev_id.$valid }">
                    <label class="control-label">{{ 'TTN_DEVID' | translate }}</label>
                    <input type="text" name="ttn_dev_id" class="form-control" ng-model="register.ttn.dev_id"
                      ng-required="register.ttnEnabled" ng-disabled="!register.ttnEnabled">
                  </div>
                  <!-- TTN DecodeOptions -->
                  <div class="form-group"
                    ng-class="{'has-error': !register.validTTNconfig, 'has-success': register.validTTNconfig }">
                    <label class="control-label">{{ 'TTN_DECODEOPTIONS' | translate }}</label>
                    <input type="text" name="ttn_decodeoptions" class="form-control monospace"
                      ng-model="register.ttn.decodeOptions" ng-disabled="register.ttn.profile === 'sensebox/home'"
                      ng-required="register.ttn.profile !== 'sensebox/home'">
                  </div>
                  <!-- TTN Port -->
                  <div class="form-group">
                    <label class="control-label">{{ 'TTN_PORT' | translate }}</label>
                    <input type="number" name="ttn_decodeoptions" class="form-control monospace"
                      ng-model="register.ttn.port" min="1" max="65535">
                  </div>
                  <div uib-alert class="alert-danger" ng-hide="register.validTTNconfig">{{ 'TTN_INVALID_DECODEOPTS' |
                    translate }}</div>
                </div>
              </uib-accordion>
            </div>
            <div class="form-group">
              <hr>
              <div class="pull-right">
                <a class="btn btn-default" ng-click="register.stepBack()">{{'PREVIOUS' | translate}}</a>
                <button type="submit"
                  ng-disabled="(senseboxForm.$valid) ? (register.senseBoxSetupValid()) ? false : true : true"
                  ng-click="register.stepForward()" class="btn btn-primary">{{'NEXT' | translate}}</button>
              </div>
            </div>
          </form>
        </wz-step>
        <wz-step wz-title="{{'STEP3' | translate}}" wz-data="{translation: 'STEP3'}">
          <hr>
          <form class="tab-pane" id="confirmation" name="confirmationForm" ng-keypress="register.enterEvent($event)"
            novalidate>
            <div class="alert alert-info" role="alert">
              <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
              {{'STEP3_DESCRIPTION' | translate}}
            </div>
            <div uib-alert ng-repeat="alert in register.alerts" ng-class="'alert-' + (alert.type)">{{alert.msg}}</div>

            <h3>senseBox</h3>
            <div class="well">
              <table class="table table-striped table-bordered">
                <tbody>
                  <tr>
                    <td style="width: 50%;">Hardware</td>
                    <td style="width: 50%;"><strong>{{register.modelSelected.name}}</strong></td>
                  </tr>
                  <tr ng-hide="register.isSenseBoxModel() === ''">
                    <td style="width: 50%;">{{'CONNECTION' | translate}}</td>
                    <td style="width: 50%;"><strong>{{register.newModel.connection}}</strong></td>
                  </tr>
                  <tr ng-hide="register.isSenseBoxModel() === 'homeV2' || register.isSenseBoxModel() ===''">
                    <td style="width: 50%;">senseBox {{'EDIT_EXTENSIONS'|translate}}</td>
                    <td style="width: 50%;"><strong
                        ng-if="register.extensions.feinstaub.id !== ''">{{'EXTENSIONS_FINE_PARTICULATE_MATTER'|translate}}</strong>
                    </td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">senseBox Name</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.name}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">{{'GROUP_NAME'|translate}}</td>
                    <td style="width: 50%;"><strong>{{register.tag}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">{{'STATION_PLACEMENT'|translate}}</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.exposure}}</strong></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div ng-show="register.modelSelected.id == 'custom'">
              <h3>{{'SENSORS' | translate}}</h3>
              <div class="well">
                <ul>
                  <li ng-repeat="sensor in register.sensors">
                    {{sensor.title}} ({{sensor.unit}}) - {{sensor.sensorType}}
                  </li>
                </ul>
              </div>
            </div>
            <div uib-alert class="alert-warning" ng-bind-html="'REGISTRATION_LICENSE'|translate"></div>
            <div class="form-group">
              <hr>
              <div class="pull-right">
                <a class="btn btn-default" ng-click="register.stepBack()">{{'PREVIOUS' | translate}}</a>
                <a class="btn btn-danger" href="/account">{{'CANCEL' | translate}}</a>
                <button type="submit" ng-click="register.completeRegistration()" wz-next
                  ng-disabled="register.registering" class="btn btn-success">{{'FINISH' | translate}}
                  <i class="fa fa-circle-o-notch fa-spin fa-fw" ng-show="register.registering"></i>
                  <span class="sr-only">Loading...</span>
                </button>
              </div>
            </div>
          </form>
        </wz-step>
        <wz-step wz-title="{{'STEP4' | translate}}" wz-data="{translation: 'STEP4'}">
          <hr>
          <form class="tab-pane" id="last" name="lastForm" rc-step>
            <!-- Firefox workaround https://github.com/sensebox/openSenseMap/issues/295-->
            <input type="password" style="display:none;">
            <!-- Firefox workaround end -->
            <div uib-alert ng-repeat="alert in register.alerts" ng-class="'alert-' + (alert.type)">{{alert.msg}}</div>

            <h3>senseBox</h3>
            <div class="well">
              <table class="table table-striped table-bordered">
                <tbody>
                  <tr>
                    <td style="width: 50%;">senseBox Model</td>
                    <td style="width: 50%;"><strong>{{register.modelSelected.name}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">senseBox Name</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.name}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">{{'GROUP_NAME'|translate}}</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.grouptag}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">{{'STATION_PLACEMENT'|translate}}</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.exposure}}</strong></td>
                  </tr>
                  <tr>
                    <td style="width: 50%;">senseBox ID</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.id}}</strong></td>
                  </tr>
                  <tr ng-if="register.newSenseBox.model == 'hackair_home_v2'">
                    <td style="width: 50%;">senseBox access token</td>
                    <td style="width: 50%;"><strong>{{register.newSenseBox.access_token}}</strong></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <h3>{{'SENSORS' | translate }} &amp; IDs</h3>
            <div class="well">
              <div uib-alert class="alert-warning" ng-show="!register.registeredSensors">
                {{'PLEASE_WAIT_DATA'|translate}}
                <i class="fa fa-circle-o-notch fa-spin fa-fw" ng-show="register.calculating"></i>
              </div>
              <table ng-show="register.registeredSensors" class="table table-striped table-bordered">
                <tbody>
                  <tr ng-repeat="sensor in register.registeredSensors">
                    <td style="width: 50%;">{{sensor.title}} ({{sensor.unit}}) - {{sensor.sensorType}}</td>
                    <td style="width: 50%;"><strong>{{sensor._id}}</strong></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <h3 ng-if="register.tag != 'edu'">Arduino Code</h3>
            <div class="alert alert-success" role="alert"
              ng-if="register.newSenseBox.model === 'homeV2WifiFeinstaub' || register.newSenseBox.model === 'homeV2Wifi'">
              <h5 ng-bind-html="'COMPILE_SKETCH'|translate"></h5>
              <div>
                <div class="form-group" ng-if="register.newSenseBox.model === 'homeV2WifiFeinstaub'">
                  <label for="serialport">{{'PORT'|translate}}</label>
                  <div class="input-group" uib-tooltip-template="'tooltip_serialports.html'" tooltip-placement="bottom"
                    tooltip-trigger="'mouseenter'">
                    <select type="text" class="form-control" id="serialport" ng-model="register.newSenseBox.serialPort"
                      ng-change="register.generateScript()">
                      <option value="Serial1">Serial 1</option>
                      <option value="Serial2">Serial 2</option>
                    </select>
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="soilDigitalPort">{{'SOIL_MOISTURE'|translate}} {{'DIGITAL_PORT'|translate}}</label>
                  <div class="input-group">
                    <select type="text" class="form-control" id="soilDigitalPort"
                      ng-model="register.newSenseBox.soilDigitalPort" ng-change="register.generateScript()">
                      <option value="A">A</option>
                      <option value="B">B</option>
                      <option value="C">C</option>
                    </select>
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="soundMeterPort">{{'SOUND_LEVEL'|translate}} {{'DIGITAL_PORT'|translate}}</label>
                  <div class="input-group">
                    <select type="text" class="form-control" id="soundMeterPort"
                      ng-model="register.newSenseBox.soundMeterPort" ng-change="register.generateScript()">
                      <option value="A">A</option>
                      <option value="B">B</option>
                      <option value="C">C</option>
                    </select>
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="ssid">WiFi SSID</label>
                  <div class="input-group" uib-tooltip="{{'DATA_NOT_STORED'|translate}}" tooltip-placement="top"
                    tooltip-trigger="'mouseenter'">
                    <input type="text" class="form-control" id="ssid" ng-model="register.wifi.ssid"
                      ng-model-options="{ debounce: 500 }" ng-change="register.generateScript()">
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="password">WiFi {{'ACCOUNT_PASSWORD'|translate}}</label>
                  <div class="input-group" uib-tooltip="{{'DATA_NOT_STORED'|translate}}" tooltip-placement="top"
                    tooltip-trigger="'mouseenter'">
                    <input type="password" class="form-control" id="password" ng-model="register.wifi.password"
                      ng-model-options="{ debounce: 500 }" ng-change="register.generateScript()" name="whatever"
                      autocomplete="new-password">
                    <!-- Chrome workaround https://github.com/sensebox/openSenseMap/issues/295 -->
                    <!-- Set name attribute and autocomplete https://stackoverflow.com/a/15917221 -->
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </div>
                  </div>
                </div>
                <button type="button" class="btn btn-success" ng-click="register.compile()"
                  ng-disabled="register.compiling">
                  <i class="fa fa-circle-o-notch fa-spin fa-fw" ng-if="register.compiling"></i> {{'COMPILE'|translate}}
                </button>
              </div>
            </div>
            <div class="well" ng-if="register.tag != 'edu'">
              <div uib-alert class="alert-warning" ng-show="!register.boxScript">{{'PLEASE_WAIT_DATA'|translate}}
                <i class="fa fa-circle-o-notch fa-spin fa-fw" ng-show="register.calculating"></i>
              </div>
              <textarea ng-show="register.boxScript" class="form-control" ng-model="register.boxScript"
                onclick="this.select()" style="resize:none;height:200px;font-family:monospace;font-size:80%"></textarea>
            </div>
            <h3>{{'USEFUL_LINKS' | translate}}</h3>
            <div class="well">
              <ul>
                <li><a href="https://books.sensebox.de">{{'MANUAL' | translate}}</a></li>
                <li><a ng-href="explore/{{register.newSenseBox.id}}">{{'YOUR_SENSEBOX' | translate}}</a></li>
              </ul>
            </div>
          </form>
        </wz-step>
      </wizard>
    </div>
  </div>
</div>